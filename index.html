<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ödev Portalı</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
  body { margin:0; font-family: 'Roboto', sans-serif; background: linear-gradient(135deg, #1e3c72, #2a5298); color:#fff; display:flex; justify-content:center; align-items:center; min-height:100vh; }
  #container { background: rgba(0,0,0,0.6); padding:30px; border-radius:15px; width:90%; max-width:500px; box-shadow:0 0 20px rgba(0,0,0,0.5); }
  h1{ text-align:center; margin-bottom:20px; }
  input, textarea, select, button { width:100%; padding:10px; margin:8px 0; border-radius:8px; border:none; font-size:16px; }
  button { background:#ff6b6b; color:#fff; cursor:pointer; font-weight:bold; transition:0.3s; }
  button:hover { background:#ff4757; }
  #home, #dashboard { display:none; }
  table { width:100%; border-collapse:collapse; margin-top:15px; }
  th, td { padding:10px; text-align:left; border-bottom:1px solid #fff3; }
  th { background: rgba(255,255,255,0.2); }
</style>
</head>
<body>
<div id="container">
  <div id="login">
    <h1>Ödev Portalı</h1>
    <input type="text" id="username" placeholder="Kullanıcı Adı">
    <input type="password" id="password" placeholder="Şifre">
    <select id="role">
      <option value="student">Öğrenci</option>
      <option value="teacher">Hoca</option>
    </select>
    <button onclick="login()">Giriş Yap</button>
    <p id="loginError" style="color:#ff6b6b;"></p>
  </div>

  <div id="home">
    <h1>Ödev Ekle</h1>
    <input type="text" id="studentName" placeholder="Öğrenci İsmi">
    <textarea id="homework" placeholder="Ödevinizi yazın..."></textarea>
    <button onclick="submitHomework()">Kaydet</button>
    <button onclick="logout()">Çıkış Yap</button>
    <p id="homeMsg" style="color:#0f0;"></p>
  </div>

  <div id="dashboard">
    <h1>Tüm Ödevler</h1>
    <table>
      <thead>
        <tr><th>Öğrenci</th><th>Ödev</th></tr>
      </thead>
      <tbody id="homeworkList"></tbody>
    </table>
    <button onclick="logout()">Çıkış Yap</button>
  </div>
</div>

<!-- Firebase compat SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyBHMkITC7aREHiP-3abjq__M0MAAX9gNz4",
    authDomain: "odev-efl.firebaseapp.com",
    projectId: "odev-efl",
    storageBucket: "odev-efl.firebasestorage.app",
    messagingSenderId: "35018411001",
    appId: "1:35018411001:web:e9782551cd9b24fd738b28"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Tek kullanıcı giriş bilgileri
  const credentials = {
    student: { username: "sinif", password: "1234" },
    teacher: { username: "hoca", password: "admin" }
  };

  let currentUser = null;

  function login() {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    const role = document.getElementById('role').value;

    if(credentials[role] && credentials[role].username === username && credentials[role].password === password){
      currentUser = { username, role };
      document.getElementById('login').style.display = 'none';
      if(role === 'student') {
        document.getElementById('home').style.display = 'block';
      } else {
        document.getElementById('dashboard').style.display = 'block';
        loadAllHomework();
      }
    } else {
      document.getElementById('loginError').innerText = "Kullanıcı adı veya şifre hatalı!";
    }
  }

  function logout() {
    currentUser = null;
    document.getElementById('login').style.display = 'block';
    document.getElementById('home').style.display = 'none';
    document.getElementById('dashboard').style.display = 'none';
    document.getElementById('homeMsg').innerText = "";
  }

  function submitHomework() {
    const studentName = document.getElementById('studentName').value.trim();
    const homework = document.getElementById('homework').value.trim();
    if(!studentName || !homework) return;

    db.collection("homeworks").add({ studentName, homework, timestamp: Date.now() })
      .then(() => {
        document.getElementById('homeMsg').innerText = "Ödev kaydedildi!";
        document.getElementById('studentName').value = "";
        document.getElementById('homework').value = "";
      })
      .catch(err => console.error(err));
  }

  function loadAllHomework() {
    const tbody = document.getElementById('homeworkList');
    tbody.innerHTML = "";
    db.collection("homeworks").orderBy("timestamp", "desc").onSnapshot(snapshot => {
      tbody.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${data.studentName}</td><td>${data.homework}</td>`;
        tbody.appendChild(tr);
      });
    });
  }
</script>
</body>
</html>
